{% extends 'dashboard/base.html' %}

{% block content %}
<div class="max-w-3xl">
    <a href="{% url 'dashboard:message_list' %}" class="inline-flex items-center gap-2 text-gray-400 hover:text-primary-400 mb-6">â† Back to messages</a>

    <div class="glass rounded-2xl p-6">
        <div class="flex items-start justify-between mb-6">
            <div>
                <h2 class="text-xl font-semibold text-white">{{ msg.name }}</h2>
                <p class="text-gray-400">{{ msg.email }}</p>
                {% if msg.phone %}<p class="text-gray-400">{{ msg.phone }}</p>{% endif %}
            </div>
            <div class="text-right">
                <span class="px-3 py-1 rounded-full text-sm {% if msg.is_replied %}bg-green-500/20 text-green-400{% else %}bg-orange-500/20 text-orange-400{% endif %}">
                    {% if msg.is_replied %}Replied{% else %}Pending{% endif %}
                </span>
                <p class="text-sm text-gray-500 mt-2">{{ msg.created_at|date:"M d, Y H:i" }}</p>
            </div>
        </div>

        <div class="mb-6">
            <span class="inline-block px-3 py-1 bg-primary-500/10 text-primary-400 rounded-lg text-sm mb-4">{{ msg.get_subject_display }}</span>
            <div class="bg-dark-900/50 rounded-xl p-6 text-gray-300 leading-relaxed">
                {{ msg.message|linebreaks }}
            </div>
        </div>

        <div class="flex items-center justify-between pt-6 border-t border-primary-500/10">
            <form method="post" action="{% url 'dashboard:message_delete' msg.pk %}" onsubmit="return confirm('Delete this message?')">
                {% csrf_token %}
                <button type="submit" class="px-4 py-2 text-red-400 hover:bg-red-500/10 rounded-lg">Delete</button>
            </form>
            <div class="flex gap-3">
                <a href="mailto:{{ msg.email }}" class="px-6 py-2 glass rounded-lg text-gray-300 hover:border-primary-500/30">Reply via Email</a>
                {% if not msg.is_replied %}
                <form method="post">
                    {% csrf_token %}
                    <button type="submit" name="mark_replied" class="px-6 py-2 bg-gradient-to-r from-primary-500 to-primary-600 text-white rounded-lg">Mark as Replied</button>
                </form>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
