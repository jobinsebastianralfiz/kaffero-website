{% extends 'dashboard/base.html' %}

{% block content %}
<div class="flex items-center gap-4 mb-6">
    <a href="?read=unread" class="px-4 py-2 rounded-lg {% if current_filter == 'unread' %}bg-primary-500/20 text-primary-400{% else %}glass text-gray-400{% endif %}">Unread</a>
    <a href="?read=read" class="px-4 py-2 rounded-lg {% if current_filter == 'read' %}bg-primary-500/20 text-primary-400{% else %}glass text-gray-400{% endif %}">Read</a>
    <a href="{% url 'dashboard:message_list' %}" class="px-4 py-2 rounded-lg {% if not current_filter %}bg-primary-500/20 text-primary-400{% else %}glass text-gray-400{% endif %}">All</a>
</div>

<div class="glass rounded-2xl overflow-hidden">
    <div class="divide-y divide-primary-500/10">
        {% for msg in messages_list %}
        <a href="{% url 'dashboard:message_detail' msg.pk %}" class="flex items-center gap-4 px-6 py-4 hover:bg-primary-500/5 {% if not msg.is_read %}bg-primary-500/5{% endif %}">
            <div class="w-10 h-10 rounded-full {% if not msg.is_read %}bg-primary-500/20{% else %}bg-gray-500/10{% endif %} flex items-center justify-center">
                ✉️
            </div>
            <div class="flex-1 min-w-0">
                <div class="flex items-center gap-2">
                    <p class="font-medium text-white">{{ msg.name }}</p>
                    {% if not msg.is_read %}<span class="w-2 h-2 rounded-full bg-primary-500"></span>{% endif %}
                </div>
                <p class="text-sm text-gray-400">{{ msg.get_subject_display }}</p>
                <p class="text-sm text-gray-500 truncate">{{ msg.message|truncatewords:15 }}</p>
            </div>
            <div class="text-right">
                <p class="text-sm text-gray-500">{{ msg.created_at|date:"M d" }}</p>
                {% if msg.is_replied %}<span class="text-xs text-green-400">Replied</span>{% endif %}
            </div>
        </a>
        {% empty %}
        <div class="px-6 py-12 text-center text-gray-500">No messages found</div>
        {% endfor %}
    </div>
</div>

{% if messages_list.has_other_pages %}
<div class="mt-6 flex justify-center gap-2">
    {% if messages_list.has_previous %}<a href="?page={{ messages_list.previous_page_number }}" class="px-4 py-2 glass rounded-lg">←</a>{% endif %}
    <span class="px-4 py-2 text-gray-400">Page {{ messages_list.number }} of {{ messages_list.paginator.num_pages }}</span>
    {% if messages_list.has_next %}<a href="?page={{ messages_list.next_page_number }}" class="px-4 py-2 glass rounded-lg">→</a>{% endif %}
</div>
{% endif %}
{% endblock %}
