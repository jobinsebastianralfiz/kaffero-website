{% load static %}
<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{{ site_name }} - {{ site_tagline }}{% endblock %}</title>
    <meta name="description" content="{% block meta_description %}{{ site_description }}{% endblock %}">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="{% static 'favicon.svg' %}">
    <link rel="apple-touch-icon" href="{% static 'favicon.svg' %}">

    <!-- SEO Meta Tags -->
    <meta name="keywords" content="{% block meta_keywords %}cafe management software, restaurant POS system, cafe POS, restaurant management system, QR code ordering, digital menu, kitchen display system, waiter app, table management software, cafe billing software, restaurant ordering system, hospitality software, food service management, cafe inventory management, restaurant analytics, cloud POS, mobile ordering app, contactless ordering, self-service kiosk, multi-outlet management{% endblock %}">
    <meta name="author" content="{{ company_name }}">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    <link rel="canonical" href="{% block canonical %}https://kaffero.online{{ request.path }}{% endblock %}">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://kaffero.online{{ request.path }}">
    <meta property="og:title" content="{% block og_title %}{{ site_name }} - {{ site_tagline }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ site_description }}{% endblock %}">
    <meta property="og:image" content="{% block og_image %}https://kaffero.online{% static 'images/og-image.png' %}{% endblock %}">
    <meta property="og:site_name" content="{{ site_name }}">
    <meta property="og:locale" content="en_US">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://kaffero.online{{ request.path }}">
    <meta name="twitter:title" content="{% block twitter_title %}{{ site_name }} - {{ site_tagline }}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}{{ site_description }}{% endblock %}">
    <meta name="twitter:image" content="{% block twitter_image %}https://kaffero.online{% static 'images/og-image.png' %}{% endblock %}">

    <!-- Additional SEO -->
    <meta name="theme-color" content="#c026d3">
    <meta name="msapplication-TileColor" content="#c026d3">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Geo Tags for International -->
    <meta name="geo.region" content="IN">
    <meta name="geo.placename" content="Kerala, India">
    <meta name="ICBM" content="10.8505, 76.2711">

    <!-- Language/Region Alternatives -->
    <link rel="alternate" hreflang="en" href="https://kaffero.online{{ request.path }}">
    <link rel="alternate" hreflang="x-default" href="https://kaffero.online{{ request.path }}">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "{{ site_name }}",
        "applicationCategory": "BusinessApplication",
        "operatingSystem": "Web, Android",
        "description": "{{ site_description }}",
        "url": "https://kaffero.online",
        "author": {
            "@type": "Organization",
            "name": "{{ company_name }}"
        },
        "offers": {
            "@type": "Offer",
            "price": "35000",
            "priceCurrency": "INR"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "50"
        }
    }
    </script>

    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75',
                        },
                        accent: {
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                        }
                    },
                    fontFamily: {
                        display: ['Space Grotesk', 'system-ui', 'sans-serif'],
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'float-delayed': 'float 6s ease-in-out 2s infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'gradient': 'gradient 8s ease infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'slide-up': 'slideUp 0.5s ease-out',
                        'fade-in': 'fadeIn 0.8s ease-out',
                        'bounce-slow': 'bounce 3s infinite',
                    },
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom Stunning Styles -->
    <style>
        * {
            scrollbar-width: thin;
            scrollbar-color: #c026d3 #1a1a2e;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1a1a2e;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #c026d3, #0ea5e9);
            border-radius: 4px;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(2deg); }
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes glow {
            from { box-shadow: 0 0 20px -10px rgba(192, 38, 211, 0.8); }
            to { box-shadow: 0 0 40px -10px rgba(14, 165, 233, 0.8); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .gradient-text {
            background: linear-gradient(135deg, #c026d3, #0ea5e9, #c026d3);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient 4s ease infinite;
        }

        .gradient-bg {
            background: linear-gradient(-45deg, #0f0f23, #1a1a2e, #16213e, #0f0f23);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }

        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-dark {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-white {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .neon-border {
            position: relative;
        }

        .neon-border::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(45deg, #c026d3, #0ea5e9, #c026d3, #0ea5e9);
            background-size: 400% 400%;
            border-radius: inherit;
            animation: gradient 3s ease infinite;
            z-index: -1;
            filter: blur(8px);
            opacity: 0.7;
        }

        .btn-stunning {
            display: inline-block;
            background: linear-gradient(135deg, #c026d3, #0ea5e9);
            padding: 1rem 2.5rem;
            border-radius: 9999px;
            font-weight: 600;
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 40px -10px rgba(192, 38, 211, 0.5);
        }

        .btn-stunning:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 20px 60px -15px rgba(192, 38, 211, 0.6);
            filter: brightness(1.1);
        }

        .btn-outline-stunning {
            position: relative;
            display: inline-block;
            padding: 1rem 2.5rem;
            border-radius: 9999px;
            font-weight: 600;
            background: transparent;
            border: 2px solid #c026d3;
            color: #e879f9;
            transition: all 0.3s ease;
        }

        .btn-outline-stunning:hover {
            background: linear-gradient(135deg, #c026d3, #0ea5e9);
            border-color: transparent;
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 10px 40px -10px rgba(192, 38, 211, 0.5);
        }

        .card-hover {
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .card-hover:hover {
            transform: translateY(-10px) scale(1.02);
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.5;
            animation: float 8s ease-in-out infinite;
        }

        .orb-1 {
            width: 400px;
            height: 400px;
            background: #c026d3;
            top: -100px;
            right: -100px;
        }

        .orb-2 {
            width: 300px;
            height: 300px;
            background: #0ea5e9;
            bottom: -50px;
            left: -50px;
            animation-delay: -4s;
        }

        .orb-3 {
            width: 200px;
            height: 200px;
            background: #f59e0b;
            top: 50%;
            left: 50%;
            animation-delay: -2s;
        }

        .floating-card {
            animation: float 6s ease-in-out infinite;
        }

        .floating-card-delayed {
            animation: float 6s ease-in-out 1s infinite;
        }

        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            background-size: 200% 100%;
            animation: shimmer 2s infinite;
        }

        .text-shadow-glow {
            text-shadow: 0 0 40px rgba(192, 38, 211, 0.5), 0 0 80px rgba(14, 165, 233, 0.3);
        }

        .form-input-stunning {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            color: white;
            transition: all 0.3s ease;
        }

        .form-input-stunning:focus {
            outline: none;
            border-color: #c026d3;
            box-shadow: 0 0 0 4px rgba(192, 38, 211, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }

        .form-input-stunning::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .section-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(192, 38, 211, 0.5), rgba(14, 165, 233, 0.5), transparent);
        }

        .icon-box {
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 16px;
            background: linear-gradient(135deg, rgba(192, 38, 211, 0.2), rgba(14, 165, 233, 0.2));
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-link {
            position: relative;
            color: rgba(255, 255, 255, 0.7);
            transition: color 0.3s ease;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #c026d3, #0ea5e9);
            transition: width 0.3s ease;
        }

        .nav-link:hover {
            color: white;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        /* Particle effect */
        .particles {
            position: absolute;
            inset: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
        }
    </style>

    {% block extra_head %}{% endblock %}
</head>
<body class="font-sans antialiased gradient-bg text-white min-h-screen">
    <!-- Navigation -->
    <nav class="fixed top-0 left-0 right-0 z-50 transition-all duration-300" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="glass-dark rounded-2xl mt-4 px-6">
                <div class="flex justify-between items-center h-16">
                    <!-- Logo -->
                    <a href="{% url 'home' %}" class="flex items-center space-x-3 group">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-primary-500 to-accent-500 flex items-center justify-center transform group-hover:rotate-12 transition-transform">
                            <span class="text-xl">&#9749;</span>
                        </div>
                        <span class="text-xl font-display font-bold gradient-text">{{ site_name }}</span>
                    </a>

                    <!-- Desktop Navigation -->
                    <div class="hidden md:flex items-center space-x-8">
                        <a href="{% url 'features' %}" class="nav-link">Features</a>
                        <a href="{% url 'pricing' %}" class="nav-link">Pricing</a>
                        <a href="{% url 'demo' %}" class="nav-link">Demo</a>
                        <a href="{% url 'about' %}" class="nav-link">About</a>
                        <a href="{% url 'contact' %}" class="nav-link">Contact</a>
                        <a href="{% url 'demo' %}" class="btn-stunning text-sm py-3 px-6">
                            Get Started
                        </a>
                    </div>

                    <!-- Mobile menu button -->
                    <button id="mobile-menu-btn" class="md:hidden p-2 rounded-lg glass" aria-label="Toggle menu">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>

                <!-- Mobile Navigation -->
                <div id="mobile-menu" class="hidden md:hidden pb-4">
                    <div class="flex flex-col space-y-3">
                        <a href="{% url 'features' %}" class="nav-link py-2">Features</a>
                        <a href="{% url 'pricing' %}" class="nav-link py-2">Pricing</a>
                        <a href="{% url 'demo' %}" class="nav-link py-2">Demo</a>
                        <a href="{% url 'about' %}" class="nav-link py-2">About</a>
                        <a href="{% url 'contact' %}" class="nav-link py-2">Contact</a>
                        <a href="{% url 'demo' %}" class="btn-stunning text-center mt-4">Get Started</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        {% if messages %}
        <div class="fixed top-24 right-4 z-50 space-y-2">
            {% for message in messages %}
            <div class="glass-dark px-6 py-4 rounded-xl animate-slide-up border-l-4 {% if message.tags == 'success' %}border-green-500{% elif message.tags == 'error' %}border-red-500{% else %}border-accent-500{% endif %}">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="relative overflow-hidden">
        <div class="section-divider"></div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12">
                <!-- Brand -->
                <div class="col-span-1 md:col-span-1">
                    <div class="flex items-center space-x-3 mb-6">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-primary-500 to-accent-500 flex items-center justify-center">
                            <span class="text-xl">&#9749;</span>
                        </div>
                        <span class="text-xl font-display font-bold gradient-text">{{ site_name }}</span>
                    </div>
                    <p class="text-gray-400 text-sm leading-relaxed">
                        The future of cafe management. Beautiful, powerful, and built for growth.
                    </p>
                </div>

                <!-- Product -->
                <div>
                    <h4 class="font-display font-semibold mb-6 text-white">Product</h4>
                    <ul class="space-y-3">
                        <li><a href="{% url 'features' %}" class="text-gray-400 hover:text-white transition">Features</a></li>
                        <li><a href="{% url 'pricing' %}" class="text-gray-400 hover:text-white transition">Pricing</a></li>
                        <li><a href="{% url 'demo' %}" class="text-gray-400 hover:text-white transition">Demo</a></li>
                    </ul>
                </div>

                <!-- Company -->
                <div>
                    <h4 class="font-display font-semibold mb-6 text-white">Company</h4>
                    <ul class="space-y-3">
                        <li><a href="{% url 'about' %}" class="text-gray-400 hover:text-white transition">About</a></li>
                        <li><a href="{% url 'blog_list' %}" class="text-gray-400 hover:text-white transition">Blog</a></li>
                        <li><a href="{% url 'contact' %}" class="text-gray-400 hover:text-white transition">Contact</a></li>
                    </ul>
                </div>

                <!-- Support -->
                <div>
                    <h4 class="font-display font-semibold mb-6 text-white">Support</h4>
                    <ul class="space-y-3">
                        <li><a href="{% url 'faq' %}" class="text-gray-400 hover:text-white transition">FAQ</a></li>
                        <li><a href="{% url 'privacy' %}" class="text-gray-400 hover:text-white transition">Privacy</a></li>
                        <li><a href="{% url 'terms' %}" class="text-gray-400 hover:text-white transition">Terms</a></li>
                    </ul>
                </div>
            </div>

            <!-- Bottom Footer -->
            <div class="section-divider mt-12 mb-8"></div>
            <div class="flex flex-col md:flex-row justify-between items-center">
                <p class="text-gray-500 text-sm">
                    &copy; {% now "Y" %} {{ company_name }}. Crafted with passion.
                </p>
                <div class="flex items-center space-x-6 mt-4 md:mt-0">
                    <a href="{{ social_linkedin }}" target="_blank" class="text-gray-400 hover:text-white transition transform hover:scale-110">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
                    </a>
                    <a href="{{ social_instagram }}" target="_blank" class="text-gray-400 hover:text-white transition transform hover:scale-110">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg>
                    </a>
                    <a href="{{ social_youtube }}" target="_blank" class="text-gray-400 hover:text-white transition transform hover:scale-110">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // Mobile Menu Toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Navbar scroll effect
        const navbar = document.getElementById('navbar');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                navbar.classList.add('backdrop-blur-lg');
            } else {
                navbar.classList.remove('backdrop-blur-lg');
            }
        });

        // Animate elements on scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate-fade-in');
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.animate-on-scroll').forEach(el => {
            el.style.opacity = '0';
            el.style.transform = 'translateY(30px)';
            el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
            observer.observe(el);
        });
    </script>

    <!-- Chatbot Widget -->
    <div id="chatbot-container" class="fixed bottom-6 right-6 z-50">
        <!-- Chat Button with pulse effect -->
        <div class="relative">
            <!-- Pulse rings -->
            <div class="absolute inset-0 rounded-full bg-gradient-to-r from-primary-500 to-accent-500 animate-ping opacity-25"></div>
            <div class="absolute inset-[-4px] rounded-full bg-gradient-to-r from-primary-500 to-accent-500 opacity-20 animate-pulse"></div>

            <!-- Main button -->
            <button id="chat-toggle" class="relative w-16 h-16 rounded-full bg-gradient-to-br from-primary-500 via-primary-600 to-accent-500 text-white shadow-2xl hover:shadow-primary-500/50 transform hover:scale-110 transition-all duration-300 flex items-center justify-center group overflow-hidden">
                <!-- Shimmer effect -->
                <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700"></div>

                <!-- Chat icon -->
                <div id="chat-icon" class="relative flex items-center justify-center">
                    <svg class="w-8 h-8 drop-shadow-lg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                    </svg>
                </div>

                <!-- Close icon -->
                <svg id="close-icon" class="w-8 h-8 hidden drop-shadow-lg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>

            <!-- Notification badge -->
            <span id="chat-badge" class="absolute -top-1 -right-1 w-5 h-5 bg-green-500 rounded-full flex items-center justify-center text-xs font-bold text-white shadow-lg border-2 border-white animate-bounce">
                1
            </span>
        </div>

        <!-- Tooltip -->
        <div id="chat-tooltip" class="absolute bottom-20 right-0 bg-white text-gray-800 px-4 py-2 rounded-lg shadow-xl text-sm font-medium whitespace-nowrap opacity-0 transform translate-y-2 transition-all duration-300 pointer-events-none">
            Chat with us!
            <div class="absolute bottom-[-6px] right-6 w-3 h-3 bg-white transform rotate-45"></div>
        </div>

        <!-- Chat Window -->
        <div id="chat-window" class="hidden absolute bottom-20 right-0 w-80 sm:w-96 h-[500px] glass-dark rounded-2xl shadow-2xl flex flex-col overflow-hidden border border-primary-500/20">
            <!-- Header -->
            <div class="bg-gradient-to-r from-primary-600 to-accent-600 p-4">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-white/20 flex items-center justify-center">
                        <span class="text-xl">&#9749;</span>
                    </div>
                    <div>
                        <h3 class="font-display font-bold text-white">Kaffero Assistant</h3>
                        <p class="text-xs text-white/70">We typically reply instantly</p>
                    </div>
                </div>
            </div>

            <!-- Messages -->
            <div id="chat-messages" class="flex-1 overflow-y-auto p-4 space-y-4">
                <!-- Welcome message -->
                <div class="flex gap-3">
                    <div class="w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-accent-500 flex-shrink-0 flex items-center justify-center">
                        <span class="text-sm">&#9749;</span>
                    </div>
                    <div class="glass rounded-2xl rounded-tl-sm p-3 max-w-[80%]">
                        <p class="text-sm text-gray-200">Hi there! &#128075; I'm Kaffero's assistant. How can I help you today?</p>
                    </div>
                </div>
            </div>

            <!-- Input -->
            <div class="p-4 border-t border-white/10">
                <form id="chat-form" class="flex gap-2">
                    <input type="text" id="chat-input" placeholder="Type your message..."
                           class="flex-1 bg-white/10 border border-white/10 rounded-xl px-4 py-3 text-sm text-white placeholder-gray-400 focus:outline-none focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20">
                    <button type="submit" class="w-12 h-12 rounded-xl bg-gradient-to-br from-primary-500 to-accent-500 flex items-center justify-center hover:opacity-90 transition-opacity">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                        </svg>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Chatbot functionality
        const chatToggle = document.getElementById('chat-toggle');
        const chatWindow = document.getElementById('chat-window');
        const chatIcon = document.getElementById('chat-icon');
        const closeIcon = document.getElementById('close-icon');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');
        const chatMessages = document.getElementById('chat-messages');
        const chatBadge = document.getElementById('chat-badge');
        const chatTooltip = document.getElementById('chat-tooltip');

        let sessionId = localStorage.getItem('kaffero_chat_session') || '';
        let isOpen = false;

        // Show tooltip on hover (only when chat is closed)
        chatToggle.addEventListener('mouseenter', () => {
            if (!isOpen) {
                chatTooltip.classList.remove('opacity-0', 'translate-y-2');
                chatTooltip.classList.add('opacity-100', 'translate-y-0');
            }
        });

        chatToggle.addEventListener('mouseleave', () => {
            chatTooltip.classList.add('opacity-0', 'translate-y-2');
            chatTooltip.classList.remove('opacity-100', 'translate-y-0');
        });

        // Toggle chat window
        chatToggle.addEventListener('click', () => {
            isOpen = !isOpen;
            chatWindow.classList.toggle('hidden');
            chatIcon.classList.toggle('hidden');
            closeIcon.classList.toggle('hidden');

            // Hide badge and tooltip when opened
            if (isOpen) {
                chatBadge.classList.add('hidden');
                chatTooltip.classList.add('opacity-0', 'translate-y-2');
                chatInput.focus();
            }
        });

        // Format message with markdown-like styling
        function formatMessage(text) {
            return text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n/g, '<br>')
                .replace(/•/g, '<span class="text-primary-400">•</span>');
        }

        // Add message to chat
        function addMessage(content, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `flex gap-3 ${isUser ? 'justify-end' : ''}`;

            if (isUser) {
                messageDiv.innerHTML = `
                    <div class="bg-gradient-to-br from-primary-500 to-accent-500 rounded-2xl rounded-tr-sm p-3 max-w-[80%]">
                        <p class="text-sm text-white">${content}</p>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-accent-500 flex-shrink-0 flex items-center justify-center">
                        <span class="text-sm">&#9749;</span>
                    </div>
                    <div class="glass rounded-2xl rounded-tl-sm p-3 max-w-[80%]">
                        <p class="text-sm text-gray-200">${formatMessage(content)}</p>
                    </div>
                `;
            }

            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Add typing indicator
        function showTyping() {
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.className = 'flex gap-3';
            typingDiv.innerHTML = `
                <div class="w-8 h-8 rounded-full bg-gradient-to-br from-primary-500 to-accent-500 flex-shrink-0 flex items-center justify-center">
                    <span class="text-sm">&#9749;</span>
                </div>
                <div class="glass rounded-2xl rounded-tl-sm p-3">
                    <div class="flex gap-1">
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                        <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function hideTyping() {
            const typingDiv = document.getElementById('typing-indicator');
            if (typingDiv) typingDiv.remove();
        }

        // Send message
        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const message = chatInput.value.trim();
            if (!message) return;

            // Add user message
            addMessage(message, true);
            chatInput.value = '';

            // Show typing indicator
            showTyping();

            try {
                const response = await fetch('/api/chat/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    body: JSON.stringify({
                        message: message,
                        session_id: sessionId
                    })
                });

                const data = await response.json();
                hideTyping();

                if (data.success) {
                    // Store session ID
                    if (data.session_id) {
                        sessionId = data.session_id;
                        localStorage.setItem('kaffero_chat_session', sessionId);
                    }
                    addMessage(data.response);
                } else {
                    addMessage('Sorry, something went wrong. Please try again.');
                }
            } catch (error) {
                hideTyping();
                addMessage('Sorry, I couldn\'t connect. Please try again later.');
            }
        });
    </script>

    {% block extra_scripts %}{% endblock %}
</body>
</html>
